<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Will IDE - Python in Browser</title>

<!-- Favicon & social preview -->
<link rel="icon" href="/favicon.ico" type="image/x-icon">
<meta property="og:title" content="Will IDE - Run Python in Your Browser">
<meta property="og:description" content="Run Python code directly in the browser with Will IDE. Save, download, and share your code instantly.">
<meta property="og:image" content="https://yourdomain.com/preview.png">
<meta property="og:url" content="https://yourdomain.com">
<meta name="twitter:card" content="summary_large_image">

<!-- CodeMirror CSS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/theme/dracula.min.css">

<style>
  body {
    font-family: monospace;
    background-color: #1e1e1e;
    color: white;
    margin: 0;
    padding: 20px;
  }

  h1 { text-align: center; }

  /* Toolbar buttons */
  #toolbar {
    text-align: center;
    margin-bottom: 10px;
  }

  #toolbar button {
    padding: 10px 20px;
    font-size: 16px;
    cursor: pointer;
    margin-right: 5px;
    margin-bottom: 5px;
  }

  /* Layout: resizable editor & output */
  #ide-container {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    justify-content: center;
  }

  #editor-container, #output-container {
    flex: 1 1 400px;
    min-width: 300px;
  }

  .CodeMirror {
    height: 300px;
  }

  #output {
    background-color: #111;
    color: #00ff00;
    border: 1px solid #333;
    padding: 10px;
    white-space: pre-wrap;
    overflow-y: auto;
    height: 300px;
  }

  #inputBox {
    width: 100%;
    padding: 6px;
    font-size: 16px;
    font-family: monospace;
    margin-top: 5px;
    display: none;
  }
</style>

<!-- Skulpt -->
<script src="https://cdn.jsdelivr.net/npm/skulpt@1.2.0/dist/skulpt.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/skulpt@1.2.0/dist/skulpt-stdlib.js"></script>

<!-- CodeMirror JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/python/python.min.js"></script>

</head>
<body>

<h1>Will IDE</h1>

<!-- Buttons toolbar -->
<div id="toolbar">
  <button id="runBtn">Run Python</button>
  <button id="downloadBtn">Download .py</button>
  <button id="shareBtn">Share this code</button>
</div>

<!-- IDE container -->
<div id="ide-container">
  <div id="editor-container">
    <textarea id="editor"></textarea>
  </div>
  <div id="output-container">
    <h2>Output:</h2>
    <pre id="output"></pre>
    <input id="inputBox" placeholder="Type input and press Enter">
  </div>
</div>

<script>
  // ----- Initialize CodeMirror -----
  const editor = CodeMirror.fromTextArea(document.getElementById("editor"), {
    mode: "python",
    theme: "dracula",
    lineNumbers: true,
    indentUnit: 4,
    tabSize: 4
  });

  const output = document.getElementById("output");
  const inputBox = document.getElementById("inputBox");
  let inputResolve = null;

  // ----- Skulpt output -----
  function outf(text) { output.textContent += text; }

  // ----- Skulpt input -----
  function builtinInput(promptText) {
    output.textContent += promptText + "\n\n";
    inputBox.style.display = "block";
    inputBox.focus();
    return new Promise(resolve => inputResolve = resolve);
  }

  inputBox.addEventListener("keydown", function(e){
    if(e.key === "Enter" && inputResolve){
      const value = inputBox.value;
      output.textContent += value + "\n";
      inputBox.value = "";
      inputBox.style.display = "none";
      inputResolve(value);
      inputResolve = null;
    }
  });

  function builtinRead(x){
    if(!Sk.builtinFiles || !Sk.builtinFiles["files"][x]) throw "File not found: '" + x + "'";
    return Sk.builtinFiles["files"][x];
  }

  // ----- Run code -----
  function runCode(){
    output.textContent = "";
    Sk.configure({
      output: outf,
      read: builtinRead,
      inputfun: builtinInput,
      inputfunTakesPrompt: true
    });
    Sk.misceval.asyncToPromise(() => Sk.importMainWithBody("<stdin>", false, editor.getValue(), true))
      .catch(err => output.textContent += err.toString());
  }

  document.getElementById("runBtn").addEventListener("click", runCode);

  // ----- 1️⃣ Auto-save in browser -----
  editor.on("change", () => localStorage.setItem("willIDE_code", editor.getValue()));

  // ----- 2️⃣ Load code from URL or LocalStorage -----
  window.onload = () => {
    const params = new URLSearchParams(window.location.search);
    const codeFromURL = params.get("code");
    if(codeFromURL){
      editor.setValue(decodeURIComponent(codeFromURL));
    } else {
      const savedCode = localStorage.getItem("willIDE_code");
      if(savedCode) editor.setValue(savedCode);
    }
    setTimeout(() => editor.refresh(), 0);
  };

  // ----- 3️⃣ Download code -----
  const downloadBtn = document.getElementById("downloadBtn");
  downloadBtn.addEventListener("click", () => {
    const code = editor.getValue();
    const blob = new Blob([code], {type:"text/plain"});
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "code.py";
    a.click();
    URL.revokeObjectURL(url);
  });

  // ----- 4️⃣ Share code -----
  function updateShareURL(){
    return `${window.location.origin}${window.location.pathname}?code=${encodeURIComponent(editor.getValue())}`;
  }

  const shareBtn = document.getElementById("shareBtn");
  shareBtn.addEventListener("click", ()=>{
    const url = updateShareURL();
    navigator.clipboard.writeText(url);
    alert("Share URL copied! Open this code in Will IDE.");
  });
</script>

</body>
</html>



